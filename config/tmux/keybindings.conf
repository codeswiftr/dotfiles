# ============================================================================
# Tmux Key Bindings
# Custom key mappings and navigation shortcuts
# ============================================================================

# Reload configuration
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# Edit configuration
bind e new-window -n "~/.tmux.conf" "EDITOR=\${EDITOR//mvim/vim} && EDITOR=\${EDITOR//gvim/vim} && \${EDITOR:-nvim} ~/.tmux.conf && tmux source ~/.tmux.conf && tmux display \"~/.tmux.conf sourced\""

# Better window splitting
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"
unbind '"'
unbind %

# Pane navigation (vim-like)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Pane resizing
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Window navigation
bind -r C-h previous-window
bind -r C-l next-window
bind Tab last-window

# Session navigation
bind C-f command-prompt -p find-session 'switch-client -t %%'

# Quick TODO window
bind -r T split-window -b -p 35 -h -c "#{pane_current_path}" "[[ -e TODO.md ]] && nvim TODO.md || nvim ~/dotfiles/todo.md"

# Copy mode improvements
set-window-option -g mode-keys vi
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi V send-keys -X select-line
bind-key -T copy-mode-vi r send-keys -X rectangle-toggle

# Cross-platform clipboard integration
if-shell "command -v pbcopy" \
    "bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'pbcopy'" \
    "bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'"

# Maximize/minimize pane
bind + run 'cut -c3- ~/.tmux.conf | sh -s _maximize_pane "#{session_name}" #D'

# Project session management
bind P command-prompt -p "Project session name:" "new-session -d -s %% -c ~/work/%%"
bind S choose-session

# Development layout shortcuts
bind D run-shell "~/.config/tmux/scripts/dev-layout.sh"
bind A run-shell "~/.config/tmux/scripts/ai-layout.sh"
bind W run-shell "~/.config/tmux/scripts/web-layout.sh"

# AI integration shortcuts
bind C-c run-shell "tmux new-window -n 'Claude' 'claude'"
bind C-g run-shell "tmux new-window -n 'Gemini' 'gemini'"
bind C-a run-shell "tmux new-window -n 'Aider' 'aider'"
bind C-r split-window -h -c "#{pane_current_path}" "ai-review-branch"
bind C-d split-window -h -c "#{pane_current_path}" "ai-analyze documentation"